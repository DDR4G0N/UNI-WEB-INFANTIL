const hamburger=document.getElementById("hamburger"),navMenu=document.getElementById("navMenu");hamburger&&navMenu&&(hamburger.addEventListener("click",()=>{hamburger.classList.toggle("active"),navMenu.classList.toggle("active")}),navMenu.addEventListener("click",e=>{const t=e.target;"A"===t.tagName&&t.getAttribute("href").startsWith("#")&&(hamburger.classList.remove("active"),navMenu.classList.remove("active"))}));const emergencyBtn=document.getElementById("emergencyBtn"),emergencyModal=document.getElementById("emergencyModal");function blockScroll(){document.body.style.overflow="hidden",document.documentElement.style.overflow="hidden"}function allowScroll(){document.body.style.overflow="auto",document.documentElement.style.overflow="auto"}function showEmergencyModal(){emergencyModal&&(emergencyModal.style.display="block",blockScroll())}function closeEmergencyModal(){emergencyModal&&(emergencyModal.style.display="none",allowScroll())}emergencyBtn&&emergencyModal&&(emergencyBtn.addEventListener("click",showEmergencyModal),emergencyModal.addEventListener("click",e=>{e.target===emergencyModal&&closeEmergencyModal()}));let cart=[];const cartIcon=document.getElementById("cartIcon"),cartCount=document.getElementById("cartCount"),cartModal=document.getElementById("cartModal"),cartItems=document.getElementById("cartItems"),cartEmpty=document.getElementById("cartEmpty"),cartSummary=document.getElementById("cartSummary"),cartTotal=document.getElementById("cartTotal");function addToCart(e,t,n){const o=cart.find(t=>t.name===e);o?o.quantity+=1:cart.push({name:e,price:parseFloat(t),image:n,quantity:1}),updateCartUI(),showCartNotification(e)}function updateCartUI(){cartCount&&(cartCount.textContent=cart.reduce((e,t)=>e+t.quantity,0)),0===cart.length?(cartEmpty&&(cartEmpty.style.display="block"),cartSummary&&(cartSummary.style.display="none"),cartItems&&(cartItems.innerHTML="")):(cartEmpty&&(cartEmpty.style.display="none"),cartSummary&&(cartSummary.style.display="block"),renderCartItems(),updateCartTotal())}function renderCartItems(){cartItems&&(cartItems.innerHTML="",cart.forEach((e,t)=>{const n=document.createElement("div");n.className="cart-item",n.innerHTML=`\n            <img src="${e.image}" alt="${e.name}" class="cart-item-image">\n            <div class="cart-item-info">\n                <div class="cart-item-name">${e.name}</div>\n                <div class="cart-item-price">$${e.price.toFixed(2)}</div>\n            </div>\n            <div class="cart-item-quantity">\n                <button class="quantity-btn" onclick="updateQuantity(${t}, -1)" ${e.quantity<=1?"disabled":""}>-</button>\n                <span class="quantity-number">${e.quantity}</span>\n                <button class="quantity-btn" onclick="updateQuantity(${t}, 1)">+</button>\n            </div>\n            <button class="remove-item" onclick="removeFromCart(${t})">×</button>\n        `,cartItems.appendChild(n)}))}function updateCartTotal(){if(!cartTotal)return;const e=cart.reduce((e,t)=>e+t.price*t.quantity,0);cartTotal.textContent=e.toFixed(2)}function showCartModal(){cartModal&&(cartModal.style.display="block",blockScroll())}function closeCartModal(){cartModal&&(cartModal.style.display="none",allowScroll())}function proceedToCheckout(){cartTotal&&alert("Redirigiendo al proceso de pago...\n\nTotal: $"+cartTotal.textContent)}function showCartNotification(e){const t=document.createElement("div");t.style.cssText="\n        position: fixed;\n        top: 100px;\n        right: 20px;\n        background: var(--primary-blue);\n        color: white;\n        padding: 1rem 1.5rem;\n        border-radius: 10px;\n        z-index: 1001;\n        font-weight: 600;\n        box-shadow: 0 4px 20px rgba(0,0,0,0.1);\n        animation: slideInRight 0.3s ease-out;\n        max-width: 300px;\n    ",t.textContent=`"${e}" agregado al carrito`,document.body.appendChild(t),setTimeout(()=>{t.style.animation="slideOutRight 0.3s ease-out",setTimeout(()=>{document.body.contains(t)&&document.body.removeChild(t)},300)},3e3)}window.updateQuantity=function(e,t){cart[e].quantity+=t,cart[e].quantity<=0&&cart.splice(e,1),updateCartUI()},window.removeFromCart=function(e){cart.splice(e,1),updateCartUI()},cartIcon&&cartModal&&(cartIcon.addEventListener("click",showCartModal),cartModal.addEventListener("click",e=>{e.target===cartModal&&closeCartModal()})),document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll(".add-to-cart").forEach(e=>{e.addEventListener("click",()=>{addToCart(e.getAttribute("data-name"),e.getAttribute("data-price"),e.getAttribute("data-image"))})}),updateCartUI()});const loginBtn=document.getElementById("loginBtn"),loginModal=document.getElementById("loginModal"),loginForm=document.getElementById("loginForm");function showLoginModal(){loginModal&&(loginModal.style.display="block",blockScroll())}function closeLoginModal(){loginModal&&(loginModal.style.display="none",allowScroll())}function scrollToSection(e){const t=document.getElementById(e);t&&t.scrollIntoView({behavior:"smooth",block:"start"})}loginBtn&&loginModal&&(loginBtn.addEventListener("click",showLoginModal),loginModal.addEventListener("click",e=>{e.target===loginModal&&closeLoginModal()})),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();const t=document.querySelector(this.getAttribute("href"));t&&t.scrollIntoView({behavior:"smooth",block:"start"})})});const contactForm=document.getElementById("contactForm");contactForm&&contactForm.addEventListener("submit",function(e){e.preventDefault();const t=document.getElementById("name").value,n=document.getElementById("email").value,o=document.getElementById("message").value;if(!t||!n||!o)return void alert("Por favor, completa todos los campos.");if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(n))return void alert("Por favor, ingresa un correo electrónico válido.");const a=contactForm.querySelector('button[type="submit"]'),c=a.textContent;a.textContent="Enviando...",a.disabled=!0,setTimeout(()=>{alert("¡Gracias por tu mensaje! Te contactaremos pronto."),contactForm.reset(),a.textContent=c,a.disabled=!1},2e3)});const observerOptions={threshold:.1,rootMargin:"0px 0px -50px 0px"},observer=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&e.target.classList.add("loading")})},observerOptions);document.querySelectorAll(".about-card, .resource-card, .product-card").forEach(e=>{observer.observe(e)});let lastScrollTop=0;const header=document.querySelector(".header");header&&window.addEventListener("scroll",()=>{const e=window.pageYOffset||document.documentElement.scrollTop;header.style.transform=e>lastScrollTop&&e>100?"translateY(-100%)":"translateY(0)",lastScrollTop=e<=0?0:e}),document.addEventListener("DOMContentLoaded",()=>{setTimeout(()=>{document.querySelectorAll(".hero-content, .floating-card").forEach(e=>{e.classList.add("loading")})},100),updateCartUI()}),emergencyBtn&&(emergencyBtn.addEventListener("mouseenter",()=>{emergencyBtn.style.animation="none"}),emergencyBtn.addEventListener("mouseleave",()=>{emergencyBtn.style.animation="pulse 2s infinite"})),document.addEventListener("keydown",e=>{"Escape"===e.key&&(closeEmergencyModal(),closeCartModal(),closeLoginModal()),"Enter"===e.key&&e.target===emergencyBtn&&showEmergencyModal(),"ArrowLeft"===e.key?changeSlide(-1):"ArrowRight"===e.key&&changeSlide(1)});const imageObserver=new IntersectionObserver((e,t)=>{e.forEach(e=>{if(e.isIntersecting){const n=e.target;n.style.transition="opacity 0.3s ease-in-out",n.complete?n.style.opacity="1":n.onload=()=>{n.style.opacity="1"},t.unobserve(n)}})});document.querySelectorAll("img:not(.logo)").forEach(e=>{e.setAttribute("loading","lazy"),e.style.opacity="0",imageObserver.observe(e)});const donacionesForm=document.getElementById("donacionesForm");donacionesForm&&donacionesForm.addEventListener("submit",function(e){e.preventDefault(),document.getElementById("donacionGracias").style.display="block",donacionesForm.reset(),setTimeout(()=>{document.getElementById("donacionGracias").style.display="none"},4e3)}),document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("emergencyBtn"),t=document.getElementById("emergencyModal");e&&t&&(e.addEventListener("click",showEmergencyModal),t.addEventListener("click",e=>{e.target===t&&closeEmergencyModal()}))}),window.addEventListener("DOMContentLoaded",function(){const e=document.getElementById("bg-music");window.addEventListener("click",function t(){e&&(e.muted=!1,e.play(),window.removeEventListener("click",t))})});const thumbs=Array.from(document.querySelectorAll(".carousel-thumb img")),modal=document.getElementById("galleryModal"),modalImg=document.getElementById("galleryModalImg"),closeBtn=document.getElementById("galleryClose"),prevBtn=document.getElementById("galleryPrev"),nextBtn=document.getElementById("galleryNext");let currentIndex=0;function showModal(e){currentIndex=e,modalImg.src=thumbs[currentIndex].getAttribute("data-full"),modalImg.alt=thumbs[currentIndex].alt,modal.style.display="flex"}thumbs.forEach((e,t)=>{e.addEventListener("click",()=>showModal(t))}),closeBtn.addEventListener("click",()=>{modal.style.display="none",modalImg.src=""}),prevBtn.addEventListener("click",()=>{currentIndex=(currentIndex-1+thumbs.length)%thumbs.length,showModal(currentIndex)}),nextBtn.addEventListener("click",()=>{currentIndex=(currentIndex+1)%thumbs.length,showModal(currentIndex)}),modal.addEventListener("click",e=>{e.target===modal&&(modal.style.display="none",modalImg.src="")}),document.addEventListener("keydown",e=>{"flex"===modal.style.display&&("ArrowLeft"===e.key&&prevBtn.click(),"ArrowRight"===e.key&&nextBtn.click(),"Escape"===e.key&&closeBtn.click())});